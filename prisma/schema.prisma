generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["omitApi"] 
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                            Int                             @id @default(autoincrement())
  email                         String                          @unique
  fullname                      String?
  imgUrl                        String?                         @map("img_url")
  password                      String
  createdAt                     DateTime                        @default(now()) @map("created_at")
  updatedAt                     DateTime                        @default(now()) @updatedAt @map("updated_at")
  faculty                       String?
  isAdmin                       Boolean                         @default(false) @map("is_admin")
  batch                         Int                             @default(2025)
  NetworkingTaskSender          NetworkingTask[]                @relation("from")
  NetworkingTaskReciever        NetworkingTask[]                @relation("to")
  NetworkingKatingTaskSender    NetworkingKatingTask[]          @relation("from")
  NetworkingKatingTaskReceiver  NetworkingKatingTask[]          @relation("to")
  ConnectionRequestSender       ConnectionRequest[]             @relation("from")
  ConnectionRequestReciever     ConnectionRequest[]             @relation("to")
  ConnectionSender              Connection[]                    @relation("from")
  ConnectionReciever            Connection[]                    @relation("to")
  Quotes                        Quotes[]
  FirstFossibSessionSubmission  FirstFossibSessionSubmission[]
  SecondFossibSessionSubmission SecondFossibSessionSubmission[]
  InsightHuntingSubmission      InsightHuntingSubmission[]
  ExplorerSubmission            ExplorerSubmission[]
  MentoringVlogSubmission       MentoringVlogSubmission[]
  MentoringReflection           MentoringReflection[]
  @@map("users")
}

model NetworkingScore {
  id     Int  @id @default(autoincrement())
  user   User @relation(fields: [userId], references: [id])
  userId Int  @map("user_id")
  score  Int

  @@map("networking_scores")
}

model Connection {
  id         Int      @id @default(autoincrement())
  from       User     @relation(fields: [fromId], references: [id], name: "from")
  fromId     Int      @map("from_id")
  to         User     @relation(fields: [toId], references: [id], name: "to")
  toId       Int      @map("to_id")
  status     String
  created_at DateTime @default(now())
  updated_at DateTime @default(now()) @updatedAt

  @@map("connections")
}

model ConnectionRequest {
  id         Int      @id @default(autoincrement())
  from       User     @relation(fields: [fromId], references: [id], name: "from")
  fromId     Int      @map("from_id")
  to         User     @relation(fields: [toId], references: [id], name: "to")
  toId       Int      @map("to_id")
  status     String
  created_at DateTime @default(now())
  updated_at DateTime @default(now()) @updatedAt

  @@map("connection_requests")
}

model Question {
  id           Int            @id @default(autoincrement())
  question     String
  created_at   DateTime       @default(now())
  updated_at   DateTime       @default(now()) @updatedAt
  group_id     Int            @default(1)
  tasks        QuestionTask[]

  @@map("questions")
}

model QuestionTask {
  question   Question       @relation(fields: [questionId], references: [id])
  questionId Int            @map("question_id")
  task       NetworkingTask @relation(fields: [fromId, toId], references: [fromId, toId])
  fromId     Int            @map("from_id")
  toId       Int            @map("to_id")
  answer     String?

  @@id([questionId, fromId, toId])
}

model NetworkingTask {
  from      User           @relation(fields: [fromId], references: [id], name: "from")
  fromId    Int            @map("from_id")
  to        User           @relation(fields: [toId], references: [id], name: "to")
  toId      Int            @map("to_id")
  img_url   String?
  questions QuestionTask[]
  is_done   Boolean        @default(false) @map("is_done")
  score     Int            @default(0) 

  @@id([fromId, toId])
}

model QuestionKating{
  id           Int            @id @default(autoincrement())
  question     String
  created_at   DateTime       @default(now())
  updated_at   DateTime       @default(now()) @updatedAt
  group_id     Int            @default(1)
  tasks        QuestionKatingTask[]

  @@map("questions_kating")
}

model QuestionKatingTask {
  question   QuestionKating       @relation(fields: [questionId], references: [id])
  questionId Int            @map("question_id")
  task       NetworkingKatingTask @relation(fields: [fromId, toId], references: [fromId, toId])
  fromId     Int            @map("from_id")
  toId       Int            @map("to_id")
  answer     String?

  @@id([questionId, fromId, toId])
}

model NetworkingKatingTask {
  from      User           @relation(fields: [fromId], references: [id], name: "from")
  fromId    Int            @map("from_id")
  to        User           @relation(fields: [toId], references: [id], name: "to")
  toId      Int            @map("to_id")
  img_url   String?
  questions QuestionKatingTask[]
  is_done   Boolean        @default(false) @map("is_done")
  score     Int            @default(0) 

  @@id([fromId, toId])
}

model Quotes {
  id         Int      @id @default(autoincrement())
  quote      String
  user       User     @relation(fields: [userId], references: [id])
  created_at DateTime @default(now())
  updated_at DateTime @default(now()) @updatedAt
  userId     Int

  @@map("quotes")
}

model FirstFossibSessionSubmission {
  id                      Int                       @id @default(autoincrement())
  user                    User                      @relation(fields: [userId], references: [id])
  file_url                String                    @map("file_url")
  description             String
  userId                  Int
}

model SecondFossibSessionSubmission {
  id                       Int                        @id @default(autoincrement())
  user                     User                       @relation(fields: [userId], references: [id])
  file_url                 String                     @map("file_url")
  description              String
  userId                   Int
}

model InsightHuntingSubmission {
  id                            Int                             @id @default(autoincrement())
  user                          User                            @relation(fields: [userId], references: [id])
  file_url                      String                          @map("file_url")
  userId                        Int
}

model ExplorerSubmission {
  id                      Int                       @id @default(autoincrement())
  user                    User                      @relation(fields: [userId], references: [id])
  img_url                 String                    @map("img_url")
  userId                  Int
}

model MentoringReflection {
  id                       Int                        @id @default(autoincrement())
  user                     User                       @relation(fields: [userId], references: [id])
  file_url                 String                     @map("file_url")
  description              String
  userId                   Int
}

model MentoringVlogSubmission {
  id                           Int                            @id @default(autoincrement())
  user                         User                           @relation(fields: [userId], references: [id])
  file_url                     String                         @map("file_url")
  userId                       Int
}